(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[941],{3376:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order",function(){return n(5047)}])},5047:function(e,t,n){"use strict";n.r(t),n.d(t,{PostOrder:function(){return N},__N_SSP:function(){return C},default:function(){return D}});var r=n(5893);n(1611);var i=n(8037),s=n(7294),o=n(8059),c=n(1664),a=n.n(c),d=n(7400),l=n(1233),u=n(7357),m=n(7212),x=n(9334),h=n(8462),p=n(5861),f=n(1057),j=n(948),g=n(7922),Z=n(629),I=n(7906),O=n(295),y=n(3252),S=n(2882),b=n(3816);let P=(0,j.ZP)(Z.Z)(e=>{let{theme:t}=e;return{backgroundColor:"dark"===t.palette.mode?"#1A2027":"#fafaf5",...t.typography.body2,padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary,borderRadius:1,boxShadow:3}});function w(e){let t=e.option.optionItems.reduce((e,t)=>e+t.price,0);if(0!==t)return t.toLocaleString("us-US",{style:"currency",currency:"USD"})}function z(e){let t=e+"=",n=decodeURIComponent(document.cookie).split(";");for(let e=0;e<n.length;e++){let r=n[e];for(;" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""}(0,j.ZP)(Z.Z)(e=>{let{theme:t}=e;return{backgroundColor:"dark"===t.palette.mode?"#1A2027":"#fafaf5",...t.typography.body2,textAlign:"center",color:t.palette.text.secondary,boxShadow:"none"}});var C=!0;function N(e){e.currentCartItems.map(e=>({orderItem:e}));let t=e.currentCartItems;console.log("formatted order data: "+JSON.stringify(t)+". cookie: "+z("token")),z("token");let n={"Content-Type":"application/json"};console.log("headers: "+JSON.stringify(n)),(0,o.X)("https://danspizza-api.azurewebsites.net/api/Order/Post","POST",t,n).then(t=>{console.log("handleFetch data: "+JSON.stringify(t)),e.setOrderPosted(!1),e.setOrderPlaced(!0),e.setHasOrder(!1),e.removeAllItems()}).catch(t=>{console.log("handleFetch error: "+t),e.setOrderPosted(!1)})}function k(e){let t=e.foodItem.customizeOptions.map(e=>e.optionItems.reduce((e,t)=>e+t.price,0)).reduce((e,t)=>e+t,0);return t.toLocaleString("us-US",{style:"currency",currency:"USD"})}function D(e){let t;let[n,o]=(0,s.useState)(!1),[c,j]=(0,s.useState)(!1),[z,C]=(0,s.useState)(!1),[D,_]=(0,s.useState)(!1);console.log("orderPlaced: "+z),console.log("order cart items: "+JSON.stringify(e.currentCartItems)),console.log("user: "+JSON.stringify(e.user)),t=e.currentCartItems.flatMap(e=>e.customizeOptions).find(e=>e.isDefaultOption)?e.currentCartItems.flatMap(e=>e.customizeOptions).find(e=>e.isDefaultOption).optionID:"";let v=e=>{console.log("handling expand. id: "+JSON.stringify(e)),e===D?_(0):_(e)};return(0,r.jsxs)(d.Z,{container:!0,rowSpacing:1,columnSpacing:2,alignItems:"center",children:[(0,r.jsx)(d.Z,{xs:12,textAlign:"center",sx:{mt:5},children:(0,r.jsx)(p.Z,{variant:"h5",component:"h2",sx:{fontWeight:500},children:"Order"})}),(0,r.jsx)(d.Z,{xs:12,textAlign:"center",children:(0,r.jsx)(S.Z,{component:Z.Z,sx:{width:"100%",mx:"auto",my:5,maxWidth:400,bgcolor:"#fafaf5"},children:(0,r.jsx)(I.Z,{size:"small",children:(0,r.jsxs)(O.Z,{children:[(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(y.Z,{children:"Name:"}),(0,r.jsxs)(y.Z,{children:[e.user.firstName," ",e.user.lastName]})]}),(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(y.Z,{children:"Email:"}),(0,r.jsx)(y.Z,{children:e.user.email})]}),(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(y.Z,{children:"Phone:"}),(0,r.jsx)(y.Z,{children:e.user.phone})]})]})})})}),(0,r.jsx)(d.Z,{xs:12,sm:6,sx:{mx:"auto"},children:(0,r.jsx)(l.Z,{spacing:1,justifyContent:"space-between",children:(0,r.jsx)(u.Z,{children:(0,r.jsx)(h.Z,{sx:{p:1},children:(0,r.jsx)(l.Z,{spacing:1,children:e.currentCartItems.map(e=>(0,r.jsx)(u.Z,{children:(0,r.jsx)(P,{onClick:()=>v(e.cartItemID),children:(0,r.jsxs)(d.Z,{container:!0,width:300,spacing:1,alignItems:"center",sx:{margin:"0 auto"},children:[(0,r.jsx)(d.Z,{xs:10,children:(0,r.jsxs)(p.Z,{component:"div",textAlign:"left",fontWeight:500,children:[e.foodName," ",e.customizeOptions.find(e=>t===e.optionID)&&"("+e.customizeOptions.find(e=>t===e.optionID).optionItems.find(e=>e).customizeOptionItem+")"]})}),(0,r.jsxs)(d.Z,{xs:12,children:[(0,r.jsx)(m.ZP,{disablePadding:!0,children:(0,r.jsx)(x.Z,{primary:D!==e.cartItemID&&(0,r.jsxs)(d.Z,{spacing:1,container:!0,children:[(0,r.jsx)(d.Z,{xs:9,children:(0,r.jsx)(p.Z,{noWrap:!0,children:e.customizeOptions.filter(e=>t!==e.optionID).flatMap(e=>e.optionItems.filter(t=>t.customizeOptionItem!==e.optionName&&t.customizeOptionItem).map(e=>e.customizeOptionItem)).join(", ")})}),(0,r.jsx)(d.Z,{xs:2,children:(0,r.jsx)(p.Z,{children:(0,r.jsx)(k,{foodItem:e})})})]})})},e.cartItemID),(0,r.jsx)(g.Z,{in:D===e.cartItemID,timeout:"auto",unmountOnExit:!0,children:e.customizeOptions.map(t=>(0,r.jsx)(h.Z,{disablePadding:!0,dense:!0,children:(0,r.jsx)(m.ZP,{sx:{bgcolor:"background.light",boxShadow:3,mb:1,borderRadius:.5},children:(0,r.jsx)(x.Z,{primary:(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",width:"100%",children:[(0,r.jsx)(p.Z,{component:"div",fontSize:".75rem",children:(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",width:"100%",children:[(0,r.jsx)(u.Z,{minWidth:75,children:(0,r.jsx)("b",{children:t.optionName===e.foodName?"Base Item: ":t.optionName+": "})}),(0,r.jsx)(u.Z,{fontSize:".75rem",children:t.optionItems.map(e=>e.customizeOptionItem).join(", ")})]})}),(0,r.jsx)(p.Z,{component:"div",fontSize:".75rem",children:(0,r.jsx)(w,{option:t})})]})})})},t.optionID))})]})]})})},e.cartItemID))})})})})}),(0,r.jsxs)(d.Z,{xs:12,textAlign:"center",children:[!z&&(0,r.jsx)(i.R,{currentCartItems:e.currentCartItems,customizeData:e.customizeData,isOrderPage:!0}),!z&&(n?(0,r.jsx)(p.Z,{textAlign:"center",sx:{minWidth:200,my:3},children:(0,r.jsx)(f.Z,{disabled:!0,sx:{mx:1},variant:"contained",children:"Place Order"})}):(0,r.jsx)(p.Z,{textAlign:"center",sx:{minWidth:200,my:3},children:(0,r.jsx)(f.Z,{onClick:()=>o(!0),sx:{mx:1},variant:"contained",children:"Place Order"})})),n&&(0,r.jsx)(N,{currentCartItems:e.currentCartItems,setError:e=>j(e),setOrderPosted:e=>o(e),setOrderPlaced:e=>C(e),setHasOrder:t=>e.setHasOrder(t),removeAllItems:()=>e.removeAllItems()}),c&&(0,r.jsx)("div",{children:c}),z&&(0,r.jsx)(u.Z,{sx:{my:3},children:(0,r.jsxs)(p.Z,{children:["Thank you for your order, ",e.user.firstName,"!",(0,r.jsx)("br",{}),"You can view your order status on your ",(0,r.jsx)(a(),{href:"/account",children:"account"})," page."]})})]})]})}}},function(e){e.O(0,[399,774,888,179],function(){return e(e.s=3376)}),_N_E=e.O()}]);